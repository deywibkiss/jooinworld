<?php// No direct access to this filedefined('_JEXEC') or die('Restricted access'); // import Joomla view libraryjimport('joomla.application.component.view'); /** * HTML View class for the HelloWorld Component */class ReferidosViewPlanes extends JView{        private $plan;		private $model_plan;		protected $items = array();		protected $itemsall = array(); 	        // Overwriting JView display method        function display($tpl = null)         {                // Assign data to the view                $this->model_plan = new ReferidosModelPlan( 'plan' );                 // Check for errors.                if (count($errors = $this->get('Errors')))                 {                        JError::raiseError(500, implode('<br />', $errors));                        return false;                }								//agregar toolbar				$this->addToolBar();								//obtengo los planes				$this->getPlanes();	                // Display the view                parent::display($tpl);	        }				/**		 * Add the page title and toolbar.		 *		 * @since	1.6		 */		protected function addToolbar()		{			$canDo  = ReferidosHelper::getActions();						JToolBarHelper::title( 'Gestión Referidos : Gestión - Planes' , 'planes');						if ($canDo->get('core.create')) {				JToolBarHelper::addNew('plan.create');			}			if ($canDo->get('core.edit')) {				JToolBarHelper::editList( 'plan.edit' );			}			if($canDo->get('core.delete')) {				JToolBarHelper::deleteList( 'Desea eliminar estos Planes?' ,'plan.delete');			}			if ($canDo->get('core.edit.state')) {				JToolBarHelper::publish('plan.publish' );				JToolBarHelper::unpublish('plan.unpublish' );			}		}				/**		 * Obtener los planes		 *		 */		protected function getPlanes()		{			$limit = JRequest::getVar( 'limit' , 10 );			$limitstart = JRequest::getVar( 'limitstart' , '');						//obtengo todos los resgistros sin aplicar el filtro del paginado			$this->itemsall = $this->model_plan->getObjects();						$prlimits = array();			if( is_numeric( $limit ) ){				$prlimits = array(						'limitstart' => $limitstart					,	'limit' => $limit				);			}						$this->items = $this->model_plan->getObjects( array() , $prlimits);						foreach( $this->items as $key=>$plan ){								//obtengo una instancia al modelo caracteristicas				$model_usercreate = new ReferidosModelPlan();								$model_usercreate->instance( $plan->id_plan );								$this->items[ $key ]->usercreate = $model_usercreate->getUserCreate();			}		}}