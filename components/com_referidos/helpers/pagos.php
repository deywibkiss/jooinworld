<?php/** * Model for "Pagos" *  */// Joomla calls and runtimesdefined( '_JEXEC' ) or die();// Initializes the Classclass PagoModel {		/**	 * Object Id	 * @var int	 */	protected $merchantId = "508440";//"500238";	/**	 * Llave de api: id unico que se obtiene del proveedor de pagos	 * @var string	 */	protected $ApiKey = "3ohupaatlloa93gfvg4sp1qfth";//"6u39nqhq8ftd0hlvnjfs66eh8c";	/**	 * Referencia de venta: un codigo unico de venta	 * @var string	 */	var $refVenta;	/**	 * Descripcion de la compra	 * @var string	 */	var $description = 'Compra de producto.';	/**	 * Valor de la compra	 * @var string	 */	var $valor;	/**	 * Iva de la compra	 * @var string	 */	var $iva = 0;	/**	 * valor base de la compra	 * @var string	 */	var $basevalor = 0;	/**	 * Email del comprador	 * @var string	 */	var $comprador_email;		/**	 * nombre del comprador	 * @var string	 */	var $comprador_name;	/**	 * Email del vendedor	 * @var string	 */	var $vendedor_email;	/**	 * Moneda de pago	 * @var bool	 */	var $currency = 'COP';	/**	 * Firma	 * @var string	 */	public $signature;	/**	 * Firma codificada	 * @var string	 */	protected $enc_signature;	/**	* Url de pagos	* @var string	*/	protected $url_pagos = "https://gateway.payulatam.com/ppp-web-gateway/";//"https://stg.gateway.payulatam.com/ppp-web-gateway";	/**	* Url de respuesta	* @var string	*/	var $url_respuesta = "";	/**	* Url de confirmacion	* @var string	*/	var $url_confirmacion = "";		/**	 * Get if the object exists	 * @var bool	 */	var $exists = false;		/**	 * Cache of results, data, queries	 * @var unknown	 */	var $data;		/**	 * Attributes Map	 * @var array	 */	var $attrs_map = array(						'refVenta'		,	'description'		,	'valor'		,	'iva'		,	'basevalor'		,	'comprador_email'		,	'comprador_name'		,	'currency'		,	'url_respuesta'		,	'url_confirmacion'	);			/**	 * Methods	 * 	 */		/**	 * Constructor	 * 	 * @param { array || int } the args to instance the model or the single id	 * 	 */	public function instance( $config = NULL ){				if( ! is_array( $config ) )			return;				// Get existing object if the id was passed through		return $this->fill( $config );	}		/**	 * Fill the model attributes with the passed arguments.	 *	 * @param { arr } Object arguments	 */	protected function fill( $args = null ){		if ( ! is_array( $args ) )			return false;			// Merge attributes	when id is not passed through		foreach ( $this->attrs_map as $attr ) {			if ( isset( $args[ $attr ] ) )				$this->$attr = $args[ $attr ];		}		// Set exists to true.		$this->exists = true;		}	/**	* Set the signature	*	*/	public function setSignature(){		$this->signature = "$this->ApiKey~$this->merchantId~$this->refVenta~$this->valor~$this->currency";		$this->enc_signature = md5( $this->signature );	}	/**	* Get the form with the data on it.	*	*/	public function getForm( $submitButton = '' ){		// Set the signature		$this->setSignature();	?>	<form name="form-pagos" id="form-pagos" method="post" action="<?php echo $this->url_pagos; ?>" target="_self">		<input type="hidden" name="merchantId" value="<?php echo $this->merchantId; ?>">		<input type="hidden" name="referenceCode" value="<?php echo $this->refVenta ?>">		<input type="hidden" name="description" value="<?php echo $this->description; ?>">		<input type="hidden" name="amount" value="<?php echo $this->valor; ?>">		<input type="hidden" name="tax" value="<?php echo $this->iva; ?>">		<input type="hidden" name="taxReturnBase" value="<?php echo $this->basevalor; ?>">		<input type="hidden" name="signature" value="<?php echo $this->enc_signature; ?>">		<input type="hidden" name="currency" value="<?php echo $this->currency; ?>">		<input type="hidden" name="buyerEmail" value="<?php echo $this->comprador_email;//"test@test.com"; ?>">    		<input type="hidden" name="confirmationUrl" value="<?php echo $this->url_confirmacion; ?>">		<input type="hidden" name="responseUrl" value="<?php echo $this->url_respuesta; ?>">        <input type="hidden" name="payerFullName" value="<?php echo $this->comprador_name?>">        <!--<input type="hidden" name="test" value="1">        <input type="hidden" name="accountId" value="500537">      -->        		<?php			if( $submitButton == '' ):		?>		<input type="submit" value="Enviar" />		<?php 			else:				echo $submitButton;			endif;		?>	</form>	<?php	}	/**	 * API of the class	 * 	 * @return { void }	 */		protected function API(){				// Instance an object with defaults		$Object = new PagoModel();				// Instance an object with args		$args = array(							'refVenta' => 'jhaskj'			,	'description' => 'Mi compra'			,	'valor' => 20000			,	'iva' => 0			,	'basevalor' => 0			,	'comprador_email' => 'comprador@example.com'			,	'comprador_name' => 'Pepito Perez'			,	'currency' => 'COP'			,	'url_respuesta' => 'http://'			,	'url_confirmacion' => 'http://'		);				$Object = new PagoModel();		$Object->instance( $args );		$Object->getForm(); // Obtiene el formulario de pagos					}}?>