<?php// Joomla calls and runtimesdefined( '_JEXEC' ) or die( 'Restricted access' );jimport( 'joomla.application.component.model' );// Begining of the controllerclass ReferidosModelPlan extends ReferidosModelDefault{		/** 	* Object id "id_plan"	* var int	*/	public $id_plan;		/**	* estado del plan	* var char	*/	public $estado_activo;		/**	* nombre del plan	* var string	*/	public $nom_plan;		/**	* descripcion	* var string	*/	public $descripcion;		/**	* fecha de creacion	* var date	*/	public $created;		/**	* fecha de creacion	* var int	*/	public $created_by;		/**	* fecha de creacion	* var date	*/	public $modified;		/**	* fecha de creacion	* var int	*/	public $modified_by;		/**	* filas que contendra la matriz	* var char	*/	public $niveles;		/**	* columnas que contendran la matriz	* var char	*/	public $personas_nivel;		/**	* estado del plan	* var char	*/	public $comision_x_persona;	/**	* estado del plan	* var char	*/	public $personas;	/**	* estado del plan	* var int	*/	public $orden;		/**	* estado del plan	* var float	*/	public $valor_pesos;		/**	* estado del plan	* var float	*/	public $valor_dolares;		/**	* si es de pago o gratuito	* var int	*/	public $tipo_plan;		/**	 * redefined Constant for table 	 * @var string	 */	const TABLE = '#__planes';		//constante base para los filtros	const FILTER_STATE = 'filter.state.plan';		/**	 * Attributes Map	 * @var array	 */	protected $attrs_map = array( 			'id_plan'		,	'estado_activo'					,	'nom_plan'		,	'descripcion'		,	'created'		,	'created_by'		,	'modified'		,	'modified_by'		,	'niveles'		,	'personas_nivel'		,	'comision_x_persona'		,	'personas'		,	'orden'			,	'valor_pesos'			,	'valor_dolares'			,	'tipo_plan'	);		/**	* Obtiene todos los planes de un usuario	* @param{ string , array } el monbre de la tabla , el array de objectos con las condiciones	* @return{ object }		*/	public function getPlanesUser( $where , $params ){				if( !is_array( $where ) )			$where = array();				$db = JFactory::getDbo();		$query = $db->getQuery(true);				$query->select( '* , a.id_plan AS id_plan' );		$query->from( self::TABLE.' AS a' );		$query->innerJoin( '#__users_planes AS b ON a.id_plan = b.id_plan' );				foreach( $where as $key=>$obj){				if( !is_object($obj) )				continue;				$query->where( $obj->key . $obj->condition . $obj->value , $obj->glue );		}			// Order ASC default		if( isset( $params[ 'order' ] ) )			$query->order( $params[ 'order' ] );					// Group By		if( isset( $params[ 'group' ] ) )				$query->group( $params[ 'group' ] );				// Limit query		if( isset( $params[ 'limit'] ) ){			$db->setQuery( $query , ( is_numeric( ( int ) $params[ 'offset']) ) ? $params[ 'offset'] : 0 , ( int ) $params[ 'limit'] );					}else{			$db->setQuery( $query ); //esto se devera quitar;		}				// loadObject  Or  loadObjectList		if( !isset($params[ 'load' ]) )			$params[ 'load' ] = 'loadObject';				return $db->$params[ 'load' ]();		}		/**	* obtine las caracteristicas del plan	*/	public function getCaracteristicasPlan( $wheres ){				if( !is_array( $wheres ) )			$wheres = array();				$db = JFactory::getDbo();		$query = $db->getQuery(true);				$query->select( '*' );		$query->from( '#__caracteristicas_planes AS a');		$query->innerJoin( '#__caracteristicas AS b ON a.id_caracteristica = b.id_caracteristica' );				$query->where( 'a.id_plan = '.$this->id_plan , 'AND');				foreach( $wheres as $key=>$wh ){						if( !is_object( $wh ) )				continue;							$query->where( $wh->key . $wh->condition . $wh->value , $wh->glue );		}				//return $query->__toString();				$db->setQuery( $query );				return $db->loadObjectList();	}	}?>