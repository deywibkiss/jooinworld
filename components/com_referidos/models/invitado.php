<?php// Joomla calls and runtimesdefined( '_JEXEC' ) or die( 'Restricted access' );jimport( 'joomla.environment.uri' );jimport( 'joomla.application.component.model' );// Begining of the controllerclass ReferidosModelInvitado extends ReferidosModelDefault{		/**	* Object id "id_invitado"	* var int	*/	public $id_invitado;		/**	* pendiente = 0; confirmado =1; pasado de tiempo=3	* var int	*/	public $estado_invt;		/**	* Object id "id_user"	* var int	*/	public $id_user;		/**	* email de invitado	* var string	*/	public $correo_invt;		/**	* nombre de invitado	* var string	*/	public $nombre_invt;		/**	* ejemplo : facebook, correo	* var int	*/	public $tipo_invt; 		/**	* fecha de invitacion	* var date	*/	public $fecha_invt;		/**	* si se invito desde facebook se almacena el id del	* usuario de facebook	* var int	*/	public $id_facebook;		/**	* id del plan del usuario con que se invito	* var int	*/	public $plan_invt;		/**	 * redefined Constant for table 	 * @var string	 */	const TABLE = '#__invitados_ref';		//constante base para los filtros	const FILTER_STATE = 'filter.state.invitado';		/**	 * Attributes Map	 * @var array	 */	public $attrs_map = array( 			'id_invitado'		,	'estado_invt'			,	'id_user'		,	'correo_invt'		,	'nombre_invt'		,	'tipo_invt'		,	'fecha_invt'		,	'id_facebook'		,	'plan_invt'	);		/**	* enviar correos a los invitados	* @params { array }, una serie de parametros si se requieren	* @return void	*/	public function sendMailInvita( $params_send = array() ){				$uri = JFactory::getURI();				//instancio la clase de Misc		$Utilities = 'Misc';		$textencrypt = $this->insertId.'_'.$this->id_user.'_'.$this->plan_invt;		//var_dump( $Utilities::Encrypt( $textencrypt ) ); die;				// Varios destinatarios		$para  = $this->correo_invt;				// subject		$titulo = ucfirst( $params_send[ 'nom_user' ] ).' '.ucfirst( $params_send[ 'appellidos_user' ] ).' Te ha invitado a unirte a JooinWorld';				// message		$mensaje = '			<html>				<head>				  <title>Invitación a JooinWorld</title>				</head>				<body>					<div class="content-mail" style="font-family: \'Calibri\', \'Helvetica Neue\'; width: 80%; height:auto; margin:0 auto; padding:0;">						<div class="titulo" style="width:100%; height:61px; background-color:#566EAC; color:#ffffff; padding: 2px 37px;">							<img src="'.$uri->root().'templates/jooinworld-home/images/logo.png">							<!--<span style="color:#CDCBE3; font-size:12px; padding: 5px 10px;">uniendo al mundo</span>-->						</div>						<div class="cuerpo" style="width:100%; padding: 25px; font-size:14px;">							<h3 style="color:#000000">Hola</h3>							<p style="margin: 20px 0px; text-align:justify;" >								<span style="color: #566EAC;" class="text-blue">'.$params_send[ 'nom_user' ].'</span>								Te ha invitado a ser parte de Jooinworld, His audiam deserunt in, eum ubique voluptatibus te. In reque dicta usu. Ne rebum dissentiet eam, vim omnis deseruisse id. Ullum deleniti vituperata at quo, insolens complectitur te eos, ea pri dico munere propriae. Vel ferri facilis ut, qui paulo ridens praesent ad.							</p>							<div class="content-img" style="width:100%; text-align:left;">								<img style="display:inline-block; border: 1px solid #B2B2B2; border-radius:5px; padding: 2px; margin-right: 5px;" src="'. $uri->root() . ( ( !empty($params_send[ 'thumb' ]) ) ? $params_send[ 'thumb' ] : 'images/user-Male-thumb.png').'" alt="'.$params_send[ 'nom_user' ].'" />								<span style="display:inline-block; vertical-align:top; color: #566EAC;" class="text-blue">'.$params_send[ 'nom_user' ].'</span>							</div>    							<div class="agradecimiento" style="width:100%; text-align:left; margin: 0px 0px 10px 0px;">								<h2 style="color:#000000">Gracias</h2>								<p style="margin: 20px 0px; text-align:justify;" >'.$params_send[ 'mensaje' ].'</p>								<a style="text-align:center; display:inline-block; padding: 2px 5px; width:150px; height:auto; font-size:36px; border-radius: 8px; background-color:#566EAC; float:right; color:#FFFFFF; text-decoration:none;" href="'. $uri->root() .'index.php?option=com_referidos&task=invitado.setregistrationref&paramsref='.urlencode( $Utilities::Encrypt( $textencrypt ) ).'" class="btn-unete">Únete</a>							</div>						</div>						<div class="pie" style="width:100%; text-align:left; font-size:12px;">							<p>Éste mensaje fué enviado manualmente por <span style="color: #566EAC;" class="text-blue">'.$params_send[ 'nom_user' ].'</span></p>						</div>					</div>				</body>			</html>		';				// Para enviar un correo HTML mail, la cabecera Content-type debe fijarse		$cabeceras  = "MIME-Version: 1.0 \r\n";		$cabeceras .= "Content-type: text/html; charset=UTF-8 \r\n";				// Cabeceras adicionales		$cabeceras .= "To: " . $para ." \r\n";		$cabeceras .= "From: ". $params_send[ 'from' ] ." \r\n";				// Mail it		mail( $para, $titulo, $mensaje, $cabeceras);	}}?>