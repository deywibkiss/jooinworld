<?php// No direct access to this filedefined('_JEXEC') or die('Restricted access'); // import Joomla view libraryjimport('joomla.application.component.view'); /** * HTML View class for the HelloWorld Component */class ReferidosViewMiMatriz extends JView{		private $model_user;		public $plan;        // Overwriting JView display method	        function display($tpl = null)         {                // Assign data to the view				$this->model_user = new ReferidosModelUser();                 // Check for errors.                if (count($errors = $this->get('Errors')))                 {                        JError::raiseError(500, implode('<br />', $errors));                        return false;                }								//obtengo la matriz				if( empty( $this->plan ) )					$this->getMatriz();								                // Display the view                parent::display($tpl);        }				/**		* obtener la matriz dependiendo del plan del usuario		* @return object		*/		public function planes(){						$user = JFactory::getUser();						$wheres = array(				0 => ( object ) array(						'key' => 'b.estado_activo'					,	'condition' => ' = '					,	'value' => '1'					,	'glue' => 'AND'				)				,				1 => ( object ) array( 						'key' => 'a.estado_plan'					,	'condition' => ' <> '					,	'value' => '0'					,	'glue' => ''				)			);						$params = array(					'order' => 'b.orden ASC'				,	'group' => 'a.id_plan'			);						$this->model_user->instance( $user->get( 'id') );			$planes = $this->model_user->getUserPlanes( $wheres , $params);						return $planes;		}				/**		* obtener la matriz dependiendo del plan del usuario		*		*/		protected function getMatriz(){						$user = JFactory::getUser();						$wheres = array(				0 => ( object ) array(						'key' => 'b.estado_activo'					,	'condition' => ' = '					,	'value' => '1'					,	'glue' => 'AND'				)				,				1 => ( object ) array( 						'key' => 'a.estado_plan'					,	'condition' => ' <> '					,	'value' => '0'					,	'glue' => 'AND'				)			);						$params = array(				'load' => 'loadObject'			);						$this->model_user->instance( $user->get('id') );			$this->plan = $this->model_user->getUserPlanes( $wheres , $params );		}				}